# Решения заданий спринта 1

## Задание 1. Разбиение фронтенд-монолита на микрофронты
### Обоснование выбора Webpack Module Federation
Для разбиения монолита использовался Webpack Module Federation, как более простой в использовании. Нам не нужно объединять разные фреймворки, а маршрутизация пока проста в реализации, поэтому Single-Spa здесь не имеет преимущества. Из того, что мы используем только React, нам нужно оптимизировать сборку, не допуская многократной загрузки общих библиотек - Single-SPA справляется с этим хуже WMF. Использование же обоих инструментов одновременно не оправданно, т.к. переусложняет проект.

### Обзор структуры проекта

    /host-microfrontend
        /src
            /components
                App.js                  // Главный компонент приложения
                Main.js                 // Основная страница приложения (с карточками)
                ProtectedRoute.js       // Компонент для роутинга
                
    /auth-microfrontend
        /src
            /components
                AuthContext.js          // Контекст аутентификации
                AuthProvider.js         // Провайдер контекста аутентификации
                InfoTooltip.js          // Всплывающая подсказка для информации
                Login.js                // Компонент входа пользователя
                Register.js             // Компонент регистрации пользователя
            /utils
                auth.js                 // Api для аутентификации
    
    /profile-microfrontend
        /src
            /components
                EditAvatarPopup.js      // Всплывающее окно для редактирования аватара
                EditProfilePopup.js     // Всплывающее окно для редактирования профиля
                PopupWithForm.js        // Универсальное всплывающее окно с формой
                Profile.js              // Компонент профиля пользователя
            /utils
                profileApi.js           // Api для работы с профилем
    
    /cards-microfrontend
        /src
            /components
                AddPlacePopup.js        // Всплывающее окно для добавления карточки
                Card.js                 // Компонент для отображения карточки
                CardsContainer.js       // Контейнер для карточек
                ImagePopup.js           // Всплывающее окно для просмотра изображения
                PopupWithForm.js        // Универсальное всплывающее окно с формой
            /utils
                api.js                  // Api для работы с карточками
                
    /shared-microfrontend
        /src
            /components
                Footer.js               // Компонент футера
                Header.js               // Компонент хедера
                PopupWithForm.js        // Универсальное всплывающее окно с формой

**host-microfrontend**: Выполняет роль основного контейнера, который загружает и управляет другими микрофронтендами. Он отвечает за маршрутизацию.

**auth-microfrontend**: Отвечает за аутентификацию пользователя, включая функции входа и регистрации. Позволяет другим микрофронтам получать информацию о статусе аутентификации пользователя.

**profile-microfrontend**: Управляет профилем пользователя, позволяя просматривать и редактировать информацию.

**cards-microfrontend**: Отвечает за отображение списка карточек и операции над ними (добавление, лайки, удаление).

**shared-microfrontend**: Содержит хедер и футер приложения.

Необходимо упомянуть, что было принято решение разместить компонент PopupWithForm в каждом используемом его микрофронте. Это сделано для экономии времени и предполагается, что все такие "глупые" ui-kit компоненты (кнопки, иконки и т.д.) будут вынесены в отдельную библиотеку и будут подгружаться как пакет. Создавать еще один микрофронтенд для одного компонента мне показалось излишним (также для экономии времени я не всегда очищал неиспользуемые стили).

### Запуск проекта
Задание выполнено на уровне 3 - проект с микрофронтами можно запустить. В compose.yaml внесены необходимые изменения, чтобы микрофронты запускались в нужном порядке.

Находясь в корневой директории необходимо собрать проект:

`docker-compose build`

Затем необходимо запустить его:

`docker-compose up`

Отмечу, что пришлось убрать тесты, т.к. они не совсем актуальны. Например, в ходе распиливания монолита мы избавились от create-react-app (что уже хорошо) - и теперь у нас index.html не находится в папке public.

Также, я поднял версию React до 18 (утилита create-mf-app ставит  его). Стоит упомянуть, что в текущей реализации компоненты не пробрасывают наверх данные (кроме auth-microfrontend, который должен синхронно отдавать контекст) - предполагается, что в дальнейшем будет использоваться глобальный менеджер состояния.


## Задание 2. Разбиение бекенд-монолита на микросервисы
[Ссылка на схему](https://drive.google.com/file/d/1TQrJyJWGBmPiyKYDjfJ_aGssQC5oMNnj/view?usp=sharing)
